# 推流模式使用指南
## 总述

如果您上课的方式是在 iPad 上手写，那么您需要用到魔果云课的推流模式进行授课，这篇文章将手把手告诉您如何使用推流模式。

推流模式需要准备的设备及软件有：
1. 魔果云课 App 教师端
2. 电脑及推流软件（以 OBS 为例）
3. iPad、手写笔及手写软件

具体的操作主要为以下三个环节：
1. 开设直播课时并选择直播模式为“推流模式”
2. 在 OBS 修改配置及推流地址
3. 在 OBS 内配置直播内容并进行推流

## 环节和步骤
### 开设直播课时并选择直播模式为“推流模式”

#### 创建直播课时

先从机构后台按照「机构管理->课程管理->查看课程」路径进入课程详情页，选择创建直播课时；


#### 选择“推流模式”进入教室

用教师账号登录魔果云课客户端，在课程表找到要直播的课程并进入教室，首次进入教室时会要求选择直播模式，需要选择“推流模式”然后进入教室；

#### 获取推流地址

教室顶部工具栏有“推流”按钮，点击即可获取推流地址（OBS 要求的推流地址格式为：推流服务器+推流码，可以点击“切换格式”选择不同格式的推流地址）。需要注意的是：“老师”身份的用户进入时默认开启推流接入；“助教”身份的用户需要点击“开始推流”按钮才能接入推流。

### 在 OBS 修改配置及推流地址

#### 设置推流地址
打开 OBS 点击右下角的“设置”按钮，在设置页面选择“推流”子页面，其中服务选择“自定义”，服务器及串流密钥来自复制自教室的推流地址，然后点击“确定”按钮进行保存；

#### 设置输出
在设置页面选择“输出”子页面，输出模式选择“高级”，关键帧间隔建议填写 1 或 2，CPU 使用预设为“ultrafast”，配置选择“baseline”，微调选择“zerolatency”，x264 填写“threads=1”，然后点击“确定”按钮进行保存。

#### 设置视频选项
在设置页面选择“视频”子页面，设置分辨率和帧率。分辨率决定了观众看到的画面清晰程度，分辨率越高画面越清晰，魔果云课支持的分辨率为高清 1280*720。FPS 是视频帧率，它控制观看视频的流畅，普通视频帧率有 24 帧- 30 帧，低于 16 帧画面看起来有卡顿感，而游戏对帧率要求比较高，一般小于 30 帧游戏会显得不连贯。最后点击“确定”按钮进行保存

#### 设置高级选项
在设置页面选择“高级”子页面，建议不启用串流延迟以减少端到端延迟；启动自动重连，建议设置重试延迟时长尽量短，网络抖动时如果连接断开可尽快重连上。

### 在 OBS 内配置直播内容并进行推流
#### 添加直播内容源
根据您的需求，在 OBS 页面“来源”处添加内容来源，比如选择“”来源，即可选择已连接电脑的 iPad 设备的画面；


#### 开始推流
准备好直播内容以后，点击 OBS 右下角“开始推流”按钮，在界面底部查看推流状态是否正常，正常如下图，若出现重复断联、推流失败等情况，请检查第二环节 OBS 的设置是否正确。

